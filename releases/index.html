<!DOCTYPE html>
<html>

<head>
    <title>Releases | Home</title>
    <link rel="stylesheet" type="text/css" href="styles/styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet"> 
</head>

<body>
    <header>
        <!-- NOT SURE ABOUT IT -->
        <div class="header_text">
                <div class="fancy">
                    RELEASES |
                    <span class="smaller"> by Lyric</span>
                </div>
        </div>
    </header>

    <main class="content"></main>
    <div class="body_bg"></div>
    <div class="bg_overlay foreground">
        <div class="triangle_tl foreground"></div>
        <div class="triangle_l foreground"></div>
        <div class="triangle_u foreground"></div>
    </div>
    
    <footer>Disclaimer: Dates may not be totally accurate</footer>

    <script>
        function pad(num, padlen, padchar) {
            var pad_char = typeof padchar !== 'undefined' ? padchar : '0';
            var pad = new Array(1 + padlen).join(pad_char);
            return (pad + num).slice(-pad.length);
        }

        // Set the date we're counting down to
        var countDownDate = new Date().getTime();
        var demo_i = 0;

        $.getJSON("data/games.json", {}, function(data) {
            for (const [key, value] of Object.entries(data)) {
                console.log(key, value);
    
                var demo = "demo" + demo_i;
    
                $("body .content").append(
                    `<div class="box">
                       <div class="overlay"></div>
                       <div class="triangle-right"></div>
                       <p>${key}</p>
                       <div class="timerbox">
                           <p id="${demo}"></p>
                       </div>
                       <div class="bg_thumb">
                           <img class="background" src="${value[1]}"/>
                       </div>
                   </div>`
                );
    
    
                (function(demo) {
                    setInterval(function () {
                    
                        var countDownDate = new Date(value[0]).getTime();
                        var now = new Date().getTime();
                        var released = false;

                        if(now > countDownDate) {
                            // This means we're past the date so it released
                            released = true;
                        }
        
                        // Find the distance between now an the count down date
                        var distance = countDownDate - now;
        
                        // Time calculations for days, hours, minutes and seconds
                        var days = pad(Math.floor(distance / (1000 * 60 * 60 * 24)), 3);
                        var hours = pad(Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)), 2);
                        var minutes = pad(Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60)), 2);
                        var seconds = pad(Math.floor((distance % (1000 * 60)) / 1000), 2);
        
                        var element = $(`#${demo}`);
                        if(!released) {
                            element.html(days + ":" + hours + ":" +
                            minutes + ":" + seconds);
                        } else {
                            element.html(`<span class="released">RELEASED</span>`);
                            element.parent().parent().find(".overlay").css({
                                "opacity": 0.8
                            });
                        }
        
                    }, 1000);
                })(demo);
    
                demo_i++;
            }
        });
        

        
    </script>
</body>


</html>